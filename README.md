# 班级请假记录系统

一个功能完善的班级请假记录管理程序，具有现代化的UI界面、宽松舒适的布局和丰富的功能。

## 版本信息

**当前版本**: v1.0.1  
**更新日期**: 2025年2月3日  
**作者**: 112114141

## 功能特点

### 1. 学生名单管理
- 添加单个学生
- 批量导入学生（每行一个姓名）
- 删除学生（支持多选删除）
- 学生名单按拼音首字母排序

### 2. 请假录入
- 选择日期录入请假信息
- 每个学生可独立选择全天或半天请假
- 直接点击学生对应的"全天"或"半天"列进行选择，无需弹窗，操作更快捷
- 点击姓名列不再弹出对话框，避免误操作
- 可同时为不同学生选择不同的请假类型
- 学生名单按拼音首字母排序，查找更方便
- 可编辑和修改历史请假数据
- 允许保存无请假记录，方便修改错误录入
- 程序启动时自动最大化窗口

### 3. 常请假名单
- 自动统计10天内请假次数≥2次的学生
- 两个名单联动：点击同一学生，两个表会同时更新

### 4. 日历功能
- 支持三种视图模式：
  - 日视图：单日查看和录入
  - 周视图：查看和录入一周的请假情况
  - 月视图：查看和录入一个月的请假情况
- 高亮显示有请假记录的日期
- 可从日历中选择日期
- 支持按月导航
- 显示当前选中日期
- 周/月视图会高亮显示范围内的所有日期

### 5. 数据统计与导出
- 支持4种统计类型：
  - 当前日期：统计选中日期的请假情况
  - 本周：统计本周的请假情况
  - 本月：统计本月的请假情况
  - 自定义：自定义日期范围统计
- 支持学生选择：可以选择全部学生或单个学生
- 自动生成统计：进入统计界面或切换类型时自动刷新
- 选择"当前日期"时，切换日期会实时更新统计列表
- 表格颜色区分：工作日、周六、周日使用不同颜色
- 统计结果分开显示全天和半天：显示每天的请假次数，并在汇总行显示总次数
- 显示请假人数和名单
- 一键导出Excel表格

### 6. Excel导出
- 可自定义导出位置
- 导出进度实时显示
- 半天请假和全天请假分开
- 工作日和周六用不同颜色区分
- 月份和星期使用中文表达
- 有数据的单元格添加细边框

### 7. 数据持久化
- 数据保存在JSON文件中
- 月初不清零，持续记录
- 首次运行自动创建数据文件

### 8. 使用教程
- 程序内置详细的使用教程
- 位于"教程"选项卡

### 9. UI设计
- 宽松舒适的布局：各个模块之间有足够的间距
- 更大的字体：标题和内容字体更大，更易读
- 更大的按钮：按钮尺寸更大，更容易点击
- 更大的表格：表格高度增加，显示更多内容
- 更清晰的视觉层次：使用颜色和间距区分不同模块

### 10. 动画效果
- 程序启动时的淡入动画
- 保存成功时的提示动画
- 所有按钮的悬停效果

### 11. 鼠标滚轮支持
- 所有可上下调节的组件都支持鼠标滚轮滚动
- 学生名单列表支持滚轮滚动
- 常请假名单列表支持滚轮滚动
- 统计结果表格支持滚轮滚动
- 删除学生对话框中的学生列表支持滚轮滚动
- 批量导入对话框中的文本输入区支持滚轮滚动

## 文件说明

| 文件 | 说明 |
|------|------|
| `班级请假记录系统.py` | 主程序文件 |
| `tkintercalendar.py` | 日历组件 |
| `students.json` | 学生名单数据文件（首次运行自动创建） |
| `leave_records.json` | 请假记录数据文件（首次运行自动创建） |
| `requirements.txt` | Python依赖包列表 |
| `班级请假记录系统.spec` | PyInstaller配置文件 |
| `README.md` | 使用说明文档 |

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行程序

### 方式一：直接运行Python脚本

```bash
python 班级请假记录系统.py
```

### 方式二：使用PyInstaller打包

```bash
pyinstaller --onefile --noconsole --name "班级请假记录系统" "班级请假记录系统.py" "tkintercalendar.py"
```

打包完成后，可执行文件位于 `dist\班级请假记录系统.exe`

## 使用说明

### 首次使用

1. 运行程序后，会在程序根目录自动创建两个文件：
   - `students.json` - 学生名单
   - `leave_records.json` - 请假记录

### 添加学生

1. 点击顶部工具栏的"➕ 添加学生"按钮
2. 输入学生姓名
3. 点击确定

### 批量导入学生

1. 点击顶部工具栏的"📥 导入学生"按钮
2. 在文本框中每行输入一个学生姓名
3. 点击"导入"

### 删除学生

1. 点击顶部工具栏的"❌ 删除学生"按钮
2. 选择要删除的学生（支持多选）
3. 点击"删除"

### 录入请假信息

1. 在左侧日历中点击选择日期
2. 在右侧"录入"选项卡的"学生名单"或"常请假名单"中：
   - 直接点击"全天"或"半天"列：快速切换该学生的请假状态
   - 点击姓名列：不会弹出对话框，避免误操作
3. 点击后会显示"✓"标记，再次点击可取消
4. 可以为不同学生选择不同的请假类型
5. 点击顶部工具栏的"💾 保存"按钮
6. 注意：如果清空了所有选择后再保存，会清空该日期的请假记录，方便修改错误录入
7. 切换日期时，学生名单会自动刷新显示该日期的请假记录

### 查看统计和导出

1. 切换到右侧的"📊 统计"选项卡
2. 选择统计类型：当前日期/本周/本月/自定义
3. 如果选择自定义，会显示日期范围输入框，设置开始和结束日期
4. 选择学生：全部学生或单个学生（选择后会保持，不会被重置）
5. 统计结果会自动生成并显示在表格中
6. 统计表格显示每天的请假次数，并在汇总行显示全天和半天的总次数
7. 表格使用颜色区分：工作日蓝色、周六黄色、周日红色
8. 选择"当前日期"时，切换日期会实时更新统计列表
9. 点击"📥 导出Excel"按钮导出表格
10. 导出进度实时显示

### 查看教程

- 切换到"📖 教程"选项卡查看详细说明

## 注意事项

- 程序支持周一至周六为上学日，周日为休息日
- 数据会自动保存，月初不清零
- 可以编辑和修改历史请假数据
- 允许保存无请假记录，方便修改错误录入
- Excel导出时会有明显的颜色区分
- 工作日和周六会用不同颜色显示
- 窗口大小改变时，统计界面会自动刷新表格

## 技术栈

- Python 3.x
- tkinter - GUI界面
- openpyxl - Excel文件处理
- PyInstaller - 打包成exe

## 系统要求

- Windows操作系统
- Python 3.7+（如运行Python脚本）
- 或直接运行打包好的exe文件（无需安装Python）

## 数据备份

建议定期备份以下数据文件：
- `students.json`
- `leave_records.json`

## 许可证

本程序仅供学习和个人使用。
