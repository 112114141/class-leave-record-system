# 🎓 班级请假记录系统

<div align="center">

![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Version](https://img.shields.io/badge/Version-1.0.1-orange.svg)

**一个让班主任不再因为统计请假而掉头发的神器**

[功能特点](#-核心功能) • [快速开始](#-快速开始) • [使用指南](#-使用指南) • [更新日志](#-更新日志)

</div>

---

## 📌 项目简介

这是一个用 Python + tkinter 开发的班级请假记录管理系统。

简单来说,就是帮你把那些乱七八糟的请假记录整理得井井有条,让你从"谁请假了?请几天?"的崩溃中解脱出来。

**适用人群**:
- 🏫 班主任
- 👨‍🏫 辅导员
- 😵‍💫 任何需要管理学生请假记录的苦命人

**为什么选择本系统?**
- ✅ 不用Excel表格手动统计,告别Ctrl+F的噩梦
- ✅ 不用担心数据丢失,自动保存,月初不清零
- ✅ 不用担心手滑误删,操作简单,容错率高
- ✅ 不用担心格式混乱,一键导出精美Excel

---

## 🎯 版本信息

| 项目 | 内容 |
|:----:|:----:|
| **当前版本** | v1.0.1 |
| **更新日期** | 2025-02-03 |
| **作者** | 112114141 |
| **开发语言** | ![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg) |
| **GUI框架** | tkinter |
| **数据格式** | JSON |
| **许可证** | MIT |

---

## ✨ 核心功能

### 👥 学生名单管理
> 再也不用为找不到学生名字而翻遍全班名单了

| 功能 | 说明 | 效率提升 |
|:----:|:----:|:--------:|
| ➕ 添加学生 | 一个一个加,慢工出细活 | ⭐⭐ |
| 📥 批量导入 | 复制粘贴,效率起飞 | ⭐⭐⭐⭐⭐ |
| ❌ 删除学生 | 支持多选,告别误删的噩梦 | ⭐⭐⭐ |
| 🔤 智能排序 | 按拼音首字母自动排序,找学生不费眼 | ⭐⭐⭐⭐ |

### 📝 请假录入
> 告别弹窗地狱,点击即选,丝般顺滑

- 📅 **日期选择**: 左侧日历,想选哪天选哪天
- ⚡ **快速录入**: 点击"全天"或"半天"列,一键搞定
- 🛡️ **误操作保护**: 点击姓名列不会弹出对话框,避免手滑
- ⏰ **历史修改**: 想改哪天改哪天,时光倒流不是梦
- 🗑️ **清空保存**: 允许保存空记录,方便纠错

### ⚠️ 常请假名单
> 自动识别"请假达人",重点关注

- 📊 **自动统计**: 10天内请假≥2次的学生自动上榜
- 🔗 **双向联动**: 两个名单同步更新,一个都不能少

### 📅 日历功能
> 三种视图,满足你的所有需求

| 视图 | 功能 | 适用场景 |
|:----:|:----:|:--------:|
| 📅 日视图 | 单日查看和录入 | 日常记录 |
| 📆 周视图 | 一周的请假情况尽收眼底 | 周报统计 |
| 🗓️ 月视图 | 整月的请假记录一目了然 | 月度总结 |

- 🌟 **高亮显示**: 有记录的日期金光闪闪
- ⬅️➡️ **月份导航**: 上个月、下个月,想看哪月看哪月

### 📊 数据统计与导出
> 统计数据,一键导出,老板看了都说好

<details>
<summary><b>📈 四种统计类型</b></summary>

| 类型 | 说明 | 使用场景 |
|:----:|:----:|:--------:|
| 📅 当前日期 | 今天谁请假了? | 日常查看 |
| 📅 本周 | 这一周谁最"忙"? | 周报准备 |
| 📅 本月 | 一个月的请假大盘点 | 月度总结 |
| 📅 自定义 | 你说了算 | 特殊需求 |

</details>

<details>
<summary><b>🎨 颜色区分</b></summary>

| 类型 | 颜色 | 含义 |
|:----:|:----:|:----:|
| 🔵 工作日 | 蓝色 | 正常上学日 |
| 🟡 周六 | 黄色 | 还要上学 😭 |
| 🔴 周日 | 红色 | 终于休息了 😊 |

</details>

- 👥 **学生选择**: 全部学生 or 单个学生,灵活切换
- 🔄 **自动刷新**: 切换选项卡自动更新,省心省力
- 📥 **Excel导出**: 一键导出,格式精美

### 💾 数据持久化
> 数据安全,永不丢失

- 💾 **JSON存储**: 轻量级,易备份
- ♾️ **长期保存**: 月初不清零,数据永流传
- 🆕 **自动创建**: 首次运行自动生成数据文件

### 🎨 UI设计
> 告别Windows 98时代的审美

- 🎨 **现代配色**: 舒适护眼
- 📐 **宽松布局**: 不拥挤,不压抑
- ✨ **动画效果**: 启动淡入、保存成功提示,仪式感拉满
- 🖱️ **鼠标滚轮**: 所有可滚动组件都支持滚轮

---

## 📁 文件说明

```
class-leave-record-system/
├── 📄 班级请假记录系统.py    # 主程序文件 (~3300行代码)
├── 📄 tkintercalendar.py      # 自定义日历组件
├── 📄 requirements.txt       # Python依赖包列表
├── 📄 README.md              # 本文档
├── 📄 .gitignore            # Git忽略配置
└── 📁 数据文件(运行时生成):
    ├── 📄 students.json     # 学生名单数据
    └── 📄 leave_records.json # 请假记录数据
```

| 文件名 | 说明 | 是否必须 |
|:------:|:----:|:--------:|
| `班级请假记录系统.py` | 主程序文件 | ✅ 必须 |
| `tkintercalendar.py` | 日历组件 | ✅ 必须 |
| `requirements.txt` | Python依赖包列表 | ✅ 必须 |
| `students.json` | 学生名单数据(首次运行自动创建) | ❌ 自动生成 |
| `leave_records.json` | 请假记录数据(首次运行自动创建) | ❌ 自动生成 |
| `README.md` | 本文档 | ❌ 可选 |
| `.gitignore` | Git忽略配置 | ❌ 可选 |

---

## 🚀 快速开始

### 环境要求

- ![Windows](https://img.shields.io/badge/OS-Windows-blue.svg) Windows操作系统
- ![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg) Python 3.7 或更高版本

### 安装步骤

<details>
<summary><b>📥 方法一: 克隆项目</b></summary>

```bash
git clone https://github.com/yourusername/class-leave-record-system.git
cd class-leave-record-system
```

</details>

<details>
<summary><b>📥 方法二: 下载ZIP</b></summary>

1. 访问项目主页
2. 点击 "Code" → "Download ZIP"
3. 解压到任意目录

</details>

### 安装依赖

```bash
pip install -r requirements.txt
```

<details>
<summary><b>📋 依赖包列表</b></summary>

| 包名 | 版本 | 用途 |
|:----:|:----:|:----:|
| openpyxl | 3.1.2 | Excel文件处理 |
| pyinstaller | 6.3.0 | 打包成exe |

</details>

### 运行程序

```bash
python 班级请假记录系统.py
```

### 打包成exe(可选)

如果你想分享给没有安装Python的同事:

```bash
pyinstaller --onefile --noconsole --name "班级请假记录系统" "班级请假记录系统.py" "tkintercalendar.py"
```

打包完成后,可执行文件位于 `dist/班级请假记录系统.exe`

---

## 📖 使用指南

### 首次使用

1. 🚀 运行程序后,程序会在根目录自动创建两个数据文件:
   - `students.json` - 学生名单
   - `leave_records.json` - 请假记录

2. 👥 先添加学生,然后就可以开始记录请假了!

### 学生管理

#### ➕ 添加单个学生

1. 点击顶部工具栏的 **"➕ 添加学生"** 按钮
2. 输入学生姓名
3. 点击确定

<details>
<summary><b>💡 小技巧</b></summary>

建议首次使用时先批量导入学生名单,效率更高!

</details>

#### 📥 批量导入学生

1. 点击顶部工具栏的 **"📥 导入学生"** 按钮
2. 在文本框中每行输入一个学生姓名
3. 点击 **"导入"**

```
张三
李四
王五
赵六
```

#### ❌ 删除学生

1. 点击顶部工具栏的 **"❌ 删除学生"** 按钮
2. 选择要删除的学生(支持多选)
3. 点击 **"删除"**

<details>
<summary><b>⚠️ 注意</b></summary>

删除学生不会删除其历史请假记录!

</details>

### 请假录入

1. 📅 在左侧日历中点击选择日期
2. 📝 在右侧 **"📝 录入"** 选项卡中:
   - 直接点击 **"全天"** 或 **"半天"** 列: 快速切换该学生的请假状态
   - 再次点击可取消选择
3. 🔄 可以为不同学生选择不同的请假类型
4. 💾 点击顶部工具栏的 **"💾 保存"** 按钮
5. 📊 切换日期时,学生名单会自动刷新显示该日期的请假记录

<details>
<summary><b>💡 使用技巧</b></summary>

- 点击姓名列不会弹出对话框,避免误操作
- 可以先选择多个学生,然后一次性保存
- 切换日期时会提示保存未保存的修改

</details>

### 数据统计

1. 📊 切换到右侧的 **"📊 统计"** 选项卡
2. 📅 选择统计类型: **选择日期/本周/本月/自定义**
3. 📝 如果选择自定义,设置开始和结束日期
4. 👥 选择学生: **全部学生** 或 **单个学生**
5. 📈 统计结果会自动生成并显示在表格中
6. 📥 点击 **"📥 导出Excel"** 按钮导出表格

<details>
<summary><b>📊 统计示例</b></summary>

**全部学生统计**:
```
日期    | 星期 | 人数 | 全天         | 半天
---------|------|------|--------------|-------------
2025-01-01 | 周三 | 2人  | 张三         | 李四
2025-01-02 | 周四 | 1人  |             | 王五
```

**单个学生统计**:
```
日期    | 星期 | 姓名 | 全天 | 半天
---------|------|------|------|------
2025-01-01 | 周三 | 张三 | ✓    |
2025-01-05 | 周日 | 张三 |      | ✓
```

</details>

### 查看教程

- 📖 切换到 **"📖 教程"** 选项卡查看详细说明

---

## 💡 注意事项

<details>
<summary><b>📌 重要提示</b></summary>

- ⚠️ 程序支持周一至周六为上学日,周日为休息日
- 💾 数据会自动保存,月初不清零
- ✏️ 可以编辑和修改历史请假数据
- 🗑️ 允许保存无请假记录,方便修改错误录入
- 📊 Excel导出时会有明显的颜色区分
- 🖥️ 窗口大小改变时,统计界面会自动刷新表格
- 🚪 关闭程序时会提示保存未保存的数据

</details>

<details>
<summary><b>🔧 常见问题</b></summary>

**Q: 数据保存在哪里?**
A: 数据保存在程序根目录的 `students.json` 和 `leave_records.json` 文件中。

**Q: 如何备份数据?**
A: 直接复制 `students.json` 和 `leave_records.json` 文件即可。

**Q: 可以在多台电脑上使用吗?**
A: 可以,将整个项目文件夹复制到其他电脑即可。

**Q: 支持Mac/Linux吗?**
A: 目前只支持Windows系统。

</details>

---

## 🛠️ 技术细节

### 数据结构

**students.json**
```json
[
  "张三",
  "李四",
  "王五"
]
```

**leave_records.json**
```json
{
  "2025-01-01": {
    "张三": {"type": "full"},
    "李四": {"type": "half"}
  },
  "2025-01-02": {
    "王五": {"type": "full"}
  }
}
```

### 关键技术点

| 技术 | 说明 | 优势 |
|:----:|:----:|:----:|
| 🔒 线程安全 | 使用锁机制保护数据写入 | 防止并发问题 |
| 💾 原子性操作 | 使用临时文件+原子替换 | 保证数据完整性 |
| ⚡ 防抖优化 | 日历更新防抖 | 避免频繁刷新 |
| 🎨 Canvas绘制 | 使用Canvas绘制统计表格 | 支持动态行高 |
| ✨ 动画效果 | 启动淡入、保存成功提示 | 仪式感拉满 |

### 项目架构

```
┌─────────────────────────────────────────────────┐
│              LeaveRecordApp (主应用)             │
├─────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌─────────────────────────┐  │
│  │  左侧面板    │  │      右侧面板           │  │
│  │  ┌────────┐  │  │  ┌───────────────────┐  │  │
│  │  │ 日历   │  │  │  │  📝 录入选项卡    │  │  │
│  │  └────────┘  │  │  ├───────────────────┤  │  │
│  │              │  │  │  📊 统计选项卡    │  │  │
│  │              │  │  ├───────────────────┤  │  │
│  │              │  │  │  📖 教程选项卡    │  │  │
│  │              │  │  └───────────────────┘  │  │
│  └──────────────┘  └─────────────────────────┘  │
├─────────────────────────────────────────────────┤
│  ┌──────────────────┐  ┌────────────────────┐  │
│  │ StudentManager   │  │ LeaveRecordManager │  │
│  │  (学生管理)      │  │  (请假记录管理)    │  │
│  └──────────────────┘  └────────────────────┘  │
├─────────────────────────────────────────────────┤
│  ┌──────────────────┐  ┌────────────────────┐  │
│  │ AnimationHelper  │  │  CalendarWidget    │  │
│  │  (动画效果)      │  │  (日历组件)        │  │
│  └──────────────────┘  └────────────────────┘  │
└─────────────────────────────────────────────────┘
```

---

## 🤝 贡献

欢迎提交 Issue 和 Pull Request!

<details>
<summary><b>📝 贡献指南</b></summary>

1. Fork 本仓库
2. 创建你的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交你的修改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启一个 Pull Request

</details>

---

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 🌟 更新日志

<details>
<summary><b>v1.0.1 (2025-02-03)</b></summary>

### ✨ 新增
- 优化UI布局,提升用户体验
- 添加动画效果(启动淡入、保存成功提示)
- 支持鼠标滚轮滚动
- 添加教程选项卡

### 🔧 优化
- 优化统计数据刷新性能
- 优化日历高亮更新(防抖)
- 优化窗口大小改变时的表格刷新

### 🐛 修复
- 修复若干已知问题
- 修复Excel导出时的格式问题

</details>

---

## 📮 联系方式

- 👤 **作者**: 112114141
- 📧 **邮箱**: your.email@example.com
- 🌐 **项目地址**: [GitHub](https://github.com/yourusername/class-leave-record-system)
- 🐛 **问题反馈**: [Issues](https://github.com/yourusername/class-leave-record-system/issues)

---

## 🙏 致谢

感谢所有为本项目做出贡献的人!

---

<div align="center">

**如果这个项目对你有帮助,请给个 ⭐ Star 支持一下!**

Made with ❤️ by 112114141

</div>
